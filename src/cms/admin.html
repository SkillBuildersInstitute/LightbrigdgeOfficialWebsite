<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS Admin - Lightbridge Consulting</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../css/styles.css">

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <!-- Quill WYSIWYG Editor -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

    <style>
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 48px;
            padding-bottom: 24px;
            border-bottom: 2px solid #eee;
        }

        .admin-header h1 {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 0;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: linear-gradient(135deg, #FFA500 0%, #FF8C00 100%);
            color: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(255, 165, 0, 0.2);
        }

        .stat-card h3 {
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 8px 0;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card p {
            font-size: 32px;
            font-weight: 700;
            margin: 0;
        }

        .admin-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .admin-tab {
            padding: 12px 24px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .admin-tab:hover {
            background: #e0e0e0;
        }

        .admin-tab.active {
            background: #FFA500;
            color: white;
            border-color: #FFA500;
        }

        .admin-panel {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .admin-panel.active {
            display: block;
        }

        .admin-panel h2 {
            margin-top: 0;
            margin-bottom: 12px;
            color: #000;
        }

        .admin-panel > p {
            color: #666;
            margin-bottom: 32px;
            font-size: 16px;
        }

        .content-editor {
            display: grid;
            gap: 32px;
        }

        .content-section {
            padding: 24px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #FFA500;
        }

        .content-section h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #000;
            font-size: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .wysiwyg-container {
            background: white;
            border-radius: 8px;
            border: 2px solid #ddd;
        }

        .editor-label {
            display: block;
            font-weight: 700;
            color: #000;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }

        .pricing-card-editor {
            background: white;
            padding: 24px;
            border-radius: 12px;
            border: 2px solid #ddd;
            transition: all 0.3s ease;
        }

        .pricing-card-editor:hover {
            border-color: #FFA500;
            box-shadow: 0 4px 12px rgba(255, 165, 0, 0.15);
        }

        .pricing-card-editor h4 {
            margin: 0 0 16px 0;
            color: #FFA500;
            font-size: 18px;
        }

        .form-submissions {
            display: grid;
            gap: 20px;
        }

        .submission-card {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 12px;
            border-left: 4px solid #FFA500;
            transition: all 0.3s ease;
        }

        .submission-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .submission-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }

        .submission-meta {
            font-size: 14px;
            color: #666;
        }

        .submission-meta strong {
            color: #000;
        }

        .submission-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        .action-buttons {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 32px;
            padding-top: 32px;
            border-top: 2px solid #eee;
        }

        .content-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .help-text {
            font-size: 13px;
            color: #666;
            font-style: italic;
            margin-top: 8px;
        }

        .success-message {
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 20px 16px;
            }

            .admin-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .admin-tabs {
                flex-direction: column;
            }

            .admin-tab {
                width: 100%;
            }

            .admin-panel {
                padding: 24px;
            }

            .pricing-grid,
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <h1>
                <i data-lucide="settings"></i>
                CMS Admin Panel
            </h1>
            <div>
                <button class="btn btn-outline" onclick="window.location.href='../index.html'">
                    <i data-lucide="home"></i>
                    View Website
                </button>
            </div>
        </div>

        <div class="admin-stats" id="adminStats">
            <div class="stat-card">
                <h3><i data-lucide="mail" style="width: 20px; height: 20px; display: inline; margin-right: 8px;"></i>Submissions</h3>
                <p id="stat-submissions">0</p>
            </div>
            <div class="stat-card">
                <h3><i data-lucide="clock" style="width: 20px; height: 20px; display: inline; margin-right: 8px;"></i>Last Updated</h3>
                <p id="stat-updated" style="font-size: 16px;">Never</p>
            </div>
            <div class="stat-card">
                <h3><i data-lucide="check-circle" style="width: 20px; height: 20px; display: inline; margin-right: 8px;"></i>Content Status</h3>
                <p id="stat-status" style="font-size: 16px;">Ready</p>
            </div>
            <div class="stat-card">
                <h3><i data-lucide="database" style="width: 20px; height: 20px; display: inline; margin-right: 8px;"></i>Storage Used</h3>
                <p id="stat-storage" style="font-size: 16px;">0 KB</p>
            </div>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="showAdminPanel('homepage')">
                <i data-lucide="home"></i> Homepage
            </button>
            <button class="admin-tab" onclick="showAdminPanel('pricing')">
                <i data-lucide="dollar-sign"></i> Pricing
            </button>
            <button class="admin-tab" onclick="showAdminPanel('about')">
                <i data-lucide="user"></i> About
            </button>
            <button class="admin-tab" onclick="showAdminPanel('services')">
                <i data-lucide="briefcase"></i> Services
            </button>
            <button class="admin-tab" onclick="showAdminPanel('legal')">
                <i data-lucide="file-text"></i> Legal
            </button>
            <button class="admin-tab" onclick="showAdminPanel('content-map')">
                <i data-lucide="edit-3"></i> Site Content
            </button>
            <button class="admin-tab" onclick="showAdminPanel('submissions')">
                <i data-lucide="mail"></i> Submissions
            </button>
            <button class="admin-tab" onclick="showAdminPanel('settings')">
                <i data-lucide="sliders"></i> Settings
            </button>
        </div>

        <!-- Homepage Content Panel -->
        <div id="homepage-panel" class="admin-panel active">
            <h2>Homepage Content Management</h2>
            <p>Update homepage content directly from here. Changes will be reflected immediately on the live site.</p>

            <div class="content-editor">
                <div class="content-section">
                    <h3>Hero Section</h3>
                    <div class="form-group">
                        <label class="form-label">Hero Badge Text</label>
                        <input type="text" id="hero-badge" class="form-input"
                               value="Empowering Your Business Since 2024"
                               placeholder="Empowering Your Business Since 2024">
                        <span class="help-text">Small badge text at the top of the hero section</span>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Hero Headline</label>
                        <input type="text" id="hero-headline" class="form-input"
                               value="Custom solutions that save time and money"
                               placeholder="Custom solutions that save time and money">
                        <span class="help-text">Main headline on the homepage</span>
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Hero Subheadline</label>
                        <div class="wysiwyg-container">
                            <div id="hero-subheadline-editor"></div>
                        </div>
                        <span class="help-text">Subheadline text with rich formatting options</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Services Section</h3>
                    <div class="form-group">
                        <label class="form-label">Services Section Title</label>
                        <input type="text" id="services-title" class="form-input"
                               value="Six Ways We Can Help Your Business"
                               placeholder="Six Ways We Can Help Your Business">
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Services Description</label>
                        <div class="wysiwyg-container"><div id="services-description-editor"></div></div>
                        <span class="help-text">The introductory text shown above the service cards. Supports emojis and HTML formatting.</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Contact Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Contact Email</label>
                            <input type="email" id="contact-email" class="form-input"
                                   value="lightbridgeconsultingco@gmail.com"
                                   placeholder="lightbridgeconsultingco@gmail.com">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Contact Phone</label>
                            <input type="tel" id="contact-phone" class="form-input"
                                   value="813-618-5333"
                                   placeholder="813-618-5333">
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="saveHomepageContent()">
                        <i data-lucide="save"></i>
                        Save Homepage Changes
                    </button>
                    <button class="btn btn-outline" onclick="previewChanges('../index.html')">
                        <i data-lucide="eye"></i>
                        Preview Homepage
                    </button>
                </div>
            </div>
        </div>

        <!-- Pricing Management Panel -->
        <div id="pricing-panel" class="admin-panel">
            <h2>Pricing Management</h2>
            <p>Manage pricing for all service offerings using dollar sign symbols (e.g., $, $$, $$$). Changes will be reflected across the entire website.</p>
            <p style="color: #666; font-size: 14px; margin-bottom: 24px;">
                <strong>Pricing Guide:</strong> Configure the ranges and labels for the pricing key shown on the homepage.
            </p>

            <div class="content-editor">
                <div class="pricing-grid">
                    <!-- Custom Solutions Pricing -->
                    <div class="pricing-card-editor">
                        <h4>Custom Solutions & Technical Training</h4>
                        <div class="form-group">
                            <label class="form-label">Price Symbol</label>
                            <input type="text" id="custom-solutions-price" class="form-input"
                                   placeholder="$$ - $$$">
                            <span class="help-text">Use dollar signs like: $, $$, $$$, etc. (e.g., "$$ - $$$")</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Price Description</label>
                            <input type="text" id="custom-solutions-desc" class="form-input"
                                   placeholder="Based on scope | 3 months support included">
                        </div>
                    </div>

                    <!-- Website Development Pricing -->
                    <div class="pricing-card-editor">
                        <h4>Website Development</h4>
                        <div class="form-group">
                            <label class="form-label">Price Symbol</label>
                            <input type="text" id="website-development-price" class="form-input"
                                   value="$ - $$"
                                   placeholder="$ - $$">
                            <span class="help-text">Use dollar signs like: $, $$, $$$, etc.</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Price Description</label>
                            <input type="text" id="website-development-desc" class="form-input"
                                   value="Delivered in less than a week | 60 days support"
                                   placeholder="Delivered in less than a week | 60 days support">
                        </div>
                    </div>

                    <!-- Lead Generation & CRM Pricing -->
                    <div class="pricing-card-editor">
                        <h4>Lead Generation & CRM Tools</h4>
                        <div class="form-group">
                            <label class="form-label">Price Symbol</label>
                            <input type="text" id="crm-tools-price" class="form-input"
                                   value="$ - $$"
                                   placeholder="$ - $$">
                            <span class="help-text">Use dollar signs like: $, $$, $$$, etc.</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Price Description</label>
                            <input type="text" id="crm-tools-desc" class="form-input"
                                   value="Implementation & setup | 60 days support"
                                   placeholder="Implementation & setup | 60 days support">
                        </div>
                    </div>

                    <!-- Workflow Automation Pricing -->
                    <div class="pricing-card-editor">
                        <h4>Workflow Automation & Integration</h4>
                        <div class="form-group">
                            <label class="form-label">Price Symbol</label>
                            <input type="text" id="workflow-automation-price" class="form-input"
                                   value="$ - $$$"
                                   placeholder="$ - $$$">
                            <span class="help-text">Use dollar signs like: $, $$, $$$, etc.</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Price Description</label>
                            <input type="text" id="workflow-automation-desc" class="form-input"
                                   value="Per implementation | 60 days support"
                                   placeholder="Per implementation | 60 days support">
                        </div>
                    </div>

                    <!-- Voice Automation Pricing -->
                    <div class="pricing-card-editor">
                        <h4>Voice Automation & Scheduling</h4>
                        <div class="form-group">
                            <label class="form-label">Price Symbol</label>
                            <input type="text" id="voice-automation-price" class="form-input"
                                   value="$ - $$"
                                   placeholder="$ - $$">
                            <span class="help-text">Use dollar signs like: $, $$, $$$, etc.</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Price Description</label>
                            <input type="text" id="voice-automation-desc" class="form-input"
                                   value="Setup + monthly fees | 30 days support"
                                   placeholder="Setup + monthly fees | 30 days support">
                        </div>
                    </div>

                    <!-- Data Analysis Pricing -->
                    <div class="pricing-card-editor">
                        <h4>Data Analysis & Reporting</h4>
                        <div class="form-group">
                            <label class="form-label">Price Symbol</label>
                            <input type="text" id="data-analysis-price" class="form-input"
                                   value="$ - $$$"
                                   placeholder="$ - $$$">
                            <span class="help-text">Use dollar signs like: $, $$, $$$, etc.</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Price Description</label>
                            <input type="text" id="data-analysis-desc" class="form-input"
                                   value="Database & dashboards | 90 days support"
                                   placeholder="Database & dashboards | 90 days support">
                        </div>
                    </div>
                </div>

                <div class="content-section" style="margin-top: 32px;">
                    <h3>General Pricing</h3>
                    <div class="form-grid">
                        <div class="form-group">
                        <label class="form-label">Business Needs Assessment</label>
                        <input type="text" id="discovery-price" class="form-input"
                               value="FREE - Complimentary"
                               placeholder="FREE - Complimentary">
                        <span class="help-text">Complimentary business assessment (no cost)</span>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Currency</label>
                            <select id="currency" class="form-select">
                                <option value="USD">USD ($)</option>
                                <option value="CAD">CAD ($)</option>
                                <option value="EUR">EUR (€)</option>
                                <option value="GBP">GBP (£)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="content-section" style="margin-top: 32px;">
                    <h3>Pricing Guide Ranges</h3>
                    <p style="color: #666; margin-bottom: 20px;">These labels and ranges appear in the Pricing Guide section on the homepage.</p>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Tier 1 Label</label>
                            <input type="text" id="pricing-guide-label-1" class="form-input" value="$" placeholder="$">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 1 Range</label>
                            <input type="text" id="pricing-guide-range-1" class="form-input" value="$2,000 - $5,000" placeholder="$2,000 - $5,000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 2 Label</label>
                            <input type="text" id="pricing-guide-label-2" class="form-input" value="$$" placeholder="$$">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 2 Range</label>
                            <input type="text" id="pricing-guide-range-2" class="form-input" value="$5,000 - $10,000" placeholder="$5,000 - $10,000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 3 Label</label>
                            <input type="text" id="pricing-guide-label-3" class="form-input" value="$$$" placeholder="$$$">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 3 Range</label>
                            <input type="text" id="pricing-guide-range-3" class="form-input" value="$10,000 - $25,000" placeholder="$10,000 - $25,000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 4 Label</label>
                            <input type="text" id="pricing-guide-label-4" class="form-input" value="$$$$" placeholder="$$$$">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 4 Range</label>
                            <input type="text" id="pricing-guide-range-4" class="form-input" value="$25,000 - $50,000" placeholder="$25,000 - $50,000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 5 Label</label>
                            <input type="text" id="pricing-guide-label-5" class="form-input" value="$$$$$" placeholder="$$$$$">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 5 Range</label>
                            <input type="text" id="pricing-guide-range-5" class="form-input" value="$50,000 - $99,999" placeholder="$50,000 - $99,999">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 6 Label</label>
                            <input type="text" id="pricing-guide-label-6" class="form-input" value="$$$$$$" placeholder="$$$$$$">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tier 6 Range</label>
                            <input type="text" id="pricing-guide-range-6" class="form-input" value="$100,000+" placeholder="$100,000+">
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="savePricingContent()">
                        <i data-lucide="save"></i>
                        Save Pricing Changes
                    </button>
                    <button class="btn btn-outline" onclick="exportPricing()">
                        <i data-lucide="download"></i>
                        Export Pricing
                    </button>
                </div>
            </div>
        </div>

        <!-- About Page Panel -->
        <div id="about-panel" class="admin-panel">
            <h2>About Page Content Management</h2>
            <p>Update about page content including timeline and credentials.</p>

            <div class="content-editor">
                <div class="content-section">
                    <h3>Hero Section</h3>
                    <div class="form-group">
                        <label class="form-label">About Page Headline</label>
                        <input type="text" id="about-headline" class="form-input"
                               value="Building Software the Right Way for Three Decades"
                               placeholder="Building Software the Right Way for Three Decades">
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Introduction</label>
                        <div class="wysiwyg-container">
                            <div id="about-intro-editor"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Description</label>
                        <div class="wysiwyg-container">
                            <div id="about-description-editor"></div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Timeline</h3>
                    <div class="form-group">
                        <label class="form-label">Timeline Title</label>
                        <input type="text" id="timeline-title" class="form-input"
                               value="Three Decades of Learning and Building"
                               placeholder="Three Decades of Learning and Building">
                    </div>
                </div>

                <div class="content-section">
                    <h3>Philosophy Section</h3>
                    <div class="form-group">
                        <label class="form-label">Philosophy Title</label>
                        <input type="text" id="philosophy-title" class="form-input"
                               value="Why Collaborative Development Works"
                               placeholder="Why Collaborative Development Works">
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="saveAboutContent()">
                        <i data-lucide="save"></i>
                        Save About Changes
                    </button>
                    <button class="btn btn-outline" onclick="previewChanges('../pages/about.html')">
                        <i data-lucide="eye"></i>
                        Preview About Page
                    </button>
                </div>
            </div>
        </div>

        <!-- Services Content Panel -->
        <div id="services-panel" class="admin-panel">
            <h2>Services Content Management</h2>
            <p>Manage service descriptions and features for all offerings.</p>

            <div class="content-editor">
                <div class="content-section">
                    <h3>Service Offerings</h3>
                    <p style="color: #666; margin-bottom: 20px;">Edit the main service descriptions that appear on the homepage service cards.</p>
                    
                    <div class="form-group">
                        <label class="editor-label">Custom Solutions Tagline</label>
                        <div class="wysiwyg-container"><div id="custom-solutions-tagline-editor"></div></div>
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Website Development Tagline</label>
                        <div class="wysiwyg-container"><div id="website-development-tagline-editor"></div></div>
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Lead Generation & CRM Tools Tagline</label>
                        <div class="wysiwyg-container"><div id="crm-tools-tagline-editor"></div></div>
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Workflow Automation Tagline</label>
                        <div class="wysiwyg-container"><div id="workflow-automation-tagline-editor"></div></div>
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Voice Automation Tagline</label>
                        <div class="wysiwyg-container"><div id="voice-automation-tagline-editor"></div></div>
                    </div>

                    <div class="form-group">
                        <label class="editor-label">Data Analysis Tagline</label>
                        <div class="wysiwyg-container"><div id="data-analysis-tagline-editor"></div></div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="saveServicesContent()">
                        <i data-lucide="save"></i>
                        Save Services Changes
                    </button>
                </div>
            </div>
        </div>

        <!-- Legal Pages Panel -->
        <div id="legal-panel" class="admin-panel">
            <h2>Legal Pages Management</h2>
            <p>Manage Privacy Policy and Terms of Service content. Use the editors below to update the full legal text.</p>

            <div class="content-editor">
                <div class="content-section">
                    <h3>Privacy Policy Content</h3>
                    <div class="form-group">
                        <label class="form-label">Privacy Policy Last Updated</label>
                        <input type="date" id="privacy-updated" class="form-input" value="2025-01-01">
                    </div>
                    
                    <div class="form-group">
                        <label class="editor-label">Privacy Policy Content</label>
                        <div class="wysiwyg-container">
                            <div id="privacy-content-editor"></div>
                        </div>
                        <span class="help-text">Edit the complete Privacy Policy content (HTML supported)</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Terms of Service Content</h3>
                    <div class="form-group">
                        <label class="form-label">Terms Last Updated</label>
                        <input type="date" id="terms-updated" class="form-input" value="2025-01-01">
                    </div>
                    
                    <div class="form-group">
                        <label class="editor-label">Terms of Service Content</label>
                        <div class="wysiwyg-container">
                            <div id="terms-content-editor"></div>
                        </div>
                        <span class="help-text">Edit the complete Terms of Service content (HTML supported)</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Legal Contact Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Company Contact Email</label>
                            <input type="email" id="legal-email" class="form-input"
                                   value="lightbridgeconsultingco@gmail.com"
                                   placeholder="lightbridgeconsultingco@gmail.com">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Company Contact Phone</label>
                            <input type="tel" id="legal-phone" class="form-input"
                                   value="813-618-5333"
                                   placeholder="813-618-5333">
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="saveLegalContent()">
                        <i data-lucide="save"></i>
                        Save Legal Changes
                    </button>
                    <button class="btn btn-outline" onclick="previewChanges('../pages/privacy.html')">
                        <i data-lucide="eye"></i>
                        Preview Privacy
                    </button>
                    <button class="btn btn-outline" onclick="previewChanges('../pages/terms.html')">
                        <i data-lucide="eye"></i>
                        Preview Terms
                    </button>
                </div>
            </div>
        </div>

        <!-- Site Content Map Panel -->
        <div id="content-map-panel" class="admin-panel">
            <h2>Site Content Map</h2>
            <p>Edit any field tagged with <code>data-cms</code> across the site. Changes are saved to CMS storage and applied everywhere.</p>

            <div class="content-editor">
                <div class="content-section">
                    <h3>All data-cms Fields</h3>
                    <div class="form-group">
                        <label class="form-label">Filter fields</label>
                        <input type="text" id="content-map-filter" class="form-input" placeholder="Search by key or content">
                        <span class="help-text">Type to filter fields by key or content. HTML is allowed for basic formatting.</span>
                    </div>
                    <div id="content-map-fields" class="content-map-grid"></div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="saveContentMap()">
                        <i data-lucide="save"></i>
                        Save Site Content
                    </button>
                    <button class="btn btn-outline" onclick="loadContentMapFromPages()">
                        <i data-lucide="refresh-cw"></i>
                        Load Defaults from Site
                    </button>
                    <button class="btn btn-outline" onclick="clearContentMap()">
                        <i data-lucide="trash-2"></i>
                        Clear Site Content
                    </button>
                </div>
            </div>
        </div>

        <!-- Form Submissions Panel -->
        <div id="submissions-panel" class="admin-panel">
            <h2>Form Submissions</h2>
            <p>All contact form submissions from your website.</p>

            <div class="form-submissions" id="formSubmissions">
                <div class="submission-card">
                    <div class="submission-header">
                        <div>
                            <p class="submission-meta"><strong>No submissions yet</strong></p>
                            <p class="submission-meta">Form submissions will appear here when visitors contact you.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Panel -->
        <div id="settings-panel" class="admin-panel">
            <h2>Settings</h2>
            <p>Configure website settings and preferences.</p>

            <div class="content-editor">
                <div class="content-section">
                    <h3>Email Notifications</h3>
                    <p style="color: #666; margin-bottom: 20px;">Configure where form submissions are sent.</p>
                    <div class="form-group">
                        <label class="form-label">Admin Email Address</label>
                        <input type="email" id="admin-email" class="form-input" 
                               value="lightbridgeconsultingco@gmail.com"
                               placeholder="lightbridgeconsultingco@gmail.com">
                        <span class="help-text">Email address to receive form submissions and inquiries</span>
                    </div>
                    <div class="form-group">
                        <label class="form-checkbox-label">
                            <input type="checkbox" id="email-notifications-enabled" class="form-checkbox" checked>
                            Enable email notifications for new form submissions
                        </label>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Analytics</h3>
                    <div class="form-group">
                        <label class="form-label">Google Analytics ID</label>
                        <input type="text" id="ga-id" class="form-input" placeholder="GA-XXXXXXXXXX">
                        <span class="help-text">Your Google Analytics tracking ID</span>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Social Media Links</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">LinkedIn URL</label>
                            <input type="url" id="linkedin-url" class="form-input" placeholder="https://linkedin.com/in/yourprofile">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Facebook URL</label>
                            <input type="url" id="facebook-url" class="form-input" placeholder="https://facebook.com/yourpage">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Twitter URL</label>
                            <input type="url" id="twitter-url" class="form-input" placeholder="https://twitter.com/yourhandle">
                        </div>
                        <div class="form-group">
                            <label class="form-label">GitHub URL</label>
                            <input type="url" id="github-url" class="form-input" placeholder="https://github.com/yourusername">
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Footer Links</h3>
                    <p style="color: #666; margin-bottom: 20px;">Manage footer navigation links. Leave blank to hide link.</p>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Case Studies URL</label>
                            <input type="url" id="case-studies-url" class="form-input" placeholder="/pages/case-studies.html or external URL">
                            <span class="help-text">Link to case studies page or leave blank to disable</span>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Blog URL</label>
                            <input type="url" id="blog-url" class="form-input" placeholder="https://yourblog.com or /pages/blog.html">
                            <span class="help-text">Link to blog or leave blank to disable</span>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Backup & Restore</h3>
                    <p style="color: #666; margin-bottom: 20px;">Export all CMS content for backup or import content from a previous export.</p>
                    <div class="form-grid">
                        <div class="form-group">
                            <button class="btn btn-outline" onclick="exportAllContent()" style="width: 100%;">
                                <i data-lucide="download"></i>
                                Export All Content
                            </button>
                            <span class="help-text">Download all CMS data as JSON file</span>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-outline" onclick="document.getElementById('import-file').click()" style="width: 100%;">
                                <i data-lucide="upload"></i>
                                Import Content
                            </button>
                            <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importAllContent(event)">
                            <span class="help-text">Restore from exported JSON file</span>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="saveSettings()">
                        <i data-lucide="save"></i>
                        Save Settings
                    </button>
                    <button class="btn btn-outline" onclick="clearCache()">
                        <i data-lucide="trash-2"></i>
                        Clear Cache
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/security.js"></script>
    <script src="../js/main.js"></script>
    <script>
        // WYSIWYG Editor instances
        let editors = {};

        // Initialize admin panel
        document.addEventListener('DOMContentLoaded', function() {
            initializeWYSIWYGEditors();
            loadAdminData();
            lucide.createIcons();
        });

        /**
         * Initialize WYSIWYG editors with Quill
         */
        function initializeWYSIWYGEditors() {
            // Hero Subheadline Editor
            editors.heroSubheadline = new Quill('#hero-subheadline-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link'],
                        ['clean']
                    ]
                },
                placeholder: 'Enter hero subheadline...'
            });

            editors.heroSubheadline.setContents([
                { insert: '30 years of engineering. 15 years teaching. One collaborative approach that transforms your vision into working software—while you understand every step.' }
            ]);

            // About Introduction Editor
            editors.aboutIntro = new Quill('#about-intro-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link'],
                        ['clean']
                    ]
                },
                placeholder: 'Enter introduction...'
            });

            editors.aboutIntro.setContents([
                { insert: 'I\'ve spent 30 years writing code, 15 years teaching others how to think about software, and over two decades solving real business problems. Lightbridge Consulting brings all of that together.' }
            ]);

            // About Description Editor
            editors.aboutDescription = new Quill('#about-description-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link'],
                        ['clean']
                    ]
                },
                placeholder: 'Enter description...'
            });

            editors.aboutDescription.setContents([
                { insert: 'What makes my approach different? I don\'t just build what you ask for—I help you discover what you actually need. Teaching database programming at the college level taught me how to break down complex problems and explain solutions clearly. That\'s what I bring to every project.' }
            ]);

            // Services Description Editor
            editors.servicesDescription = new Quill('#services-description-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link'],
                        ['clean']
                    ]
                },
                placeholder: 'Enter services introduction...'
            });

            // Services Taglines Editors
            const taglineToolbar = {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['clean']
                    ]
                }
            };

            editors.customSolutionsTagline = new Quill('#custom-solutions-tagline-editor', taglineToolbar);
            editors.websiteDevelopmentTagline = new Quill('#website-development-tagline-editor', taglineToolbar);
            editors.crmToolsTagline = new Quill('#crm-tools-tagline-editor', taglineToolbar);
            editors.workflowAutomationTagline = new Quill('#workflow-automation-tagline-editor', taglineToolbar);
            editors.voiceAutomationTagline = new Quill('#voice-automation-tagline-editor', taglineToolbar);
            editors.dataAnalysisTagline = new Quill('#data-analysis-tagline-editor', taglineToolbar);

            // Privacy Policy Content Editor
            editors.privacyContent = new Quill('#privacy-content-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, 3, false] }],
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link'],
                        ['clean']
                    ]
                },
                placeholder: 'Enter Privacy Policy content...'
            });

            // Terms of Service Content Editor
            editors.termsContent = new Quill('#terms-content-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, 3, false] }],
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link'],
                        ['clean']
                    ]
                },
                placeholder: 'Enter Terms of Service content...'
            });

            // Set default content for Privacy Policy
            editors.privacyContent.setText('Privacy Policy content will be loaded here. Click Save to persist changes.');

            // Set default content for Terms of Service  
            editors.termsContent.setText('Terms of Service content will be loaded here. Click Save to persist changes.');
        }

        /**
         * Show specific admin panel
         * @param {string} panelName - Name of the panel to show
         */
        function showAdminPanel(panelName) {
            // Hide all panels
            document.querySelectorAll('.admin-panel').forEach(panel => {
                panel.classList.remove('active');
            });

            // Remove active state from all tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected panel
            const panel = document.getElementById(`${panelName}-panel`);
            if (panel) {
                panel.classList.add('active');
            }

            // Activate corresponding tab
            event.target.classList.add('active');

            // Refresh icons
            lucide.createIcons();
        }

        /**
         * Load all admin data from localStorage
         */
        function loadAdminData() {
            loadHomepageData();
            loadAboutData();
            loadLegalData();
            loadPricingData();
            loadServicesData();
            loadContentMapData();
            loadSettings();
            loadSubmissions();
            updateStats();
        }

        /**
         * Load homepage data
         */
        function loadHomepageData() {
            const content = JSON.parse(localStorage.getItem('cms_homepage_content') || '{}');
            
            if (content.heroHeadline) document.getElementById('hero-headline').value = content.heroHeadline;
            if (content.servicesTitle) document.getElementById('services-title').value = content.servicesTitle;
            if (editors.servicesDescription && (content.servicesDescriptionHTML || content.servicesDescription)) {
                const html = content.servicesDescriptionHTML || content.servicesDescription;
                editors.servicesDescription.root.innerHTML = html;
            }
            if (content.contactEmail) document.getElementById('contact-email').value = content.contactEmail;
            if (content.contactPhone) document.getElementById('contact-phone').value = content.contactPhone;
        }

        /**
         * Load about page data
         */
        function loadAboutData() {
            const content = JSON.parse(localStorage.getItem('cms_about_content') || '{}');
            
            if (content.aboutHeadline) document.getElementById('about-headline').value = content.aboutHeadline;
            if (content.timelineTitle) document.getElementById('timeline-title').value = content.timelineTitle;
            if (content.philosophyTitle) document.getElementById('philosophy-title').value = content.philosophyTitle;
        }

        /**
         * Load legal content data
         */
        function loadLegalData() {
            const content = JSON.parse(localStorage.getItem('cms_legal_content') || '{}');
            
            if (content.privacyUpdated) document.getElementById('privacy-updated').value = content.privacyUpdated;
            if (content.termsUpdated) document.getElementById('terms-updated').value = content.termsUpdated;
            if (content.legalEmail) document.getElementById('legal-email').value = content.legalEmail;
            if (content.legalPhone) document.getElementById('legal-phone').value = content.legalPhone;
            
            // Load Privacy Policy content
            if (content.privacyContent && editors.privacyContent) {
                editors.privacyContent.setContents(content.privacyContent);
            }
            
            // Load Terms content
            if (content.termsContent && editors.termsContent) {
                editors.termsContent.setContents(content.termsContent);
            }
        }

        /**
         * Load pricing data
         */
        function loadPricingData() {
            const pricing = JSON.parse(localStorage.getItem('cms_pricing') || '{}');
            
            // Set defaults if no saved data exists
            const defaults = {
                customSolutions: {
                    price: '$$ - $$$',
                    description: 'Based on scope | 3 months support included'
                },
                websiteDevelopment: {
                    price: '$ - $$',
                    description: 'Delivered in less than a week | 60 days support'
                },
                crmTools: {
                    price: '$ - $$',
                    description: 'Implementation & setup | 60 days support'
                },
                workflowAutomation: {
                    price: '$ - $$$',
                    description: 'Per implementation | 60 days support'
                },
                voiceAutomation: {
                    price: '$ - $$',
                    description: 'Setup + monthly fees | 30 days support'
                },
                dataAnalysis: {
                    price: '$ - $$$',
                    description: 'Database & dashboards | 90 days support'
                }
            };
            
            // Load Custom Solutions
            const customSolutions = pricing.customSolutions || defaults.customSolutions;
            document.getElementById('custom-solutions-price').value = customSolutions.price;
            document.getElementById('custom-solutions-desc').value = customSolutions.description;
            
            // Load Website Development
            const websiteDevelopment = pricing.websiteDevelopment || defaults.websiteDevelopment;
            document.getElementById('website-development-price').value = websiteDevelopment.price;
            document.getElementById('website-development-desc').value = websiteDevelopment.description;
            
            // Load CRM Tools
            const crmTools = pricing.crmTools || defaults.crmTools;
            document.getElementById('crm-tools-price').value = crmTools.price;
            document.getElementById('crm-tools-desc').value = crmTools.description;
            
            // Load Workflow Automation
            const workflowAutomation = pricing.workflowAutomation || defaults.workflowAutomation;
            document.getElementById('workflow-automation-price').value = workflowAutomation.price;
            document.getElementById('workflow-automation-desc').value = workflowAutomation.description;
            
            // Load Voice Automation
            const voiceAutomation = pricing.voiceAutomation || defaults.voiceAutomation;
            document.getElementById('voice-automation-price').value = voiceAutomation.price;
            document.getElementById('voice-automation-desc').value = voiceAutomation.description;
            
            // Load Data Analysis
            const dataAnalysis = pricing.dataAnalysis || defaults.dataAnalysis;
            document.getElementById('data-analysis-price').value = dataAnalysis.price;
            document.getElementById('data-analysis-desc').value = dataAnalysis.description;
            
            // Load Discovery Price
            if (pricing.discovery) {
                document.getElementById('discovery-price').value = pricing.discovery;
            } else {
                document.getElementById('discovery-price').value = 'FREE - Complimentary';
            }

            // Load Pricing Guide
            const defaultGuide = [
                { label: '$', range: '$2,000 - $5,000' },
                { label: '$$', range: '$5,000 - $10,000' },
                { label: '$$$', range: '$10,000 - $25,000' },
                { label: '$$$$', range: '$25,000 - $50,000' },
                { label: '$$$$$', range: '$50,000 - $99,999' },
                { label: '$$$$$$', range: '$100,000+' }
            ];

            const pricingGuide = Array.isArray(pricing.pricingGuide) ? pricing.pricingGuide : defaultGuide;
            pricingGuide.forEach((tier, index) => {
                const slot = index + 1;
                const labelInput = document.getElementById(`pricing-guide-label-${slot}`);
                const rangeInput = document.getElementById(`pricing-guide-range-${slot}`);
                if (labelInput && tier.label) labelInput.value = tier.label;
                if (rangeInput && tier.range) rangeInput.value = tier.range;
            });
        }

        /**
         * Load services (taglines) data
         */
        function loadServicesData() {
            const services = JSON.parse(localStorage.getItem('cms_services') || '{}');

            if (services.customSolutions && editors.customSolutionsTagline) {
                const html = services.customSolutions.taglineHTML || services.customSolutions.tagline || '';
                if (html) {
                    editors.customSolutionsTagline.root.innerHTML = html;
                }
            }
            if (services.websiteDevelopment && editors.websiteDevelopmentTagline) {
                const html = services.websiteDevelopment.taglineHTML || services.websiteDevelopment.tagline || '';
                if (html) {
                    editors.websiteDevelopmentTagline.root.innerHTML = html;
                }
            }
            if (services.crmTools && editors.crmToolsTagline) {
                const html = services.crmTools.taglineHTML || services.crmTools.tagline || '';
                if (html) {
                    editors.crmToolsTagline.root.innerHTML = html;
                }
            }
            if (services.workflowAutomation && editors.workflowAutomationTagline) {
                const html = services.workflowAutomation.taglineHTML || services.workflowAutomation.tagline || '';
                if (html) {
                    editors.workflowAutomationTagline.root.innerHTML = html;
                }
            }
            if (services.voiceAutomation && editors.voiceAutomationTagline) {
                const html = services.voiceAutomation.taglineHTML || services.voiceAutomation.tagline || '';
                if (html) {
                    editors.voiceAutomationTagline.root.innerHTML = html;
                }
            }
            if (services.dataAnalysis && editors.dataAnalysisTagline) {
                const html = services.dataAnalysis.taglineHTML || services.dataAnalysis.tagline || '';
                if (html) {
                    editors.dataAnalysisTagline.root.innerHTML = html;
                }
            }
        }

        /**
         * Load settings
         */
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('cms_settings') || '{}');
            
            if (settings.adminEmail) document.getElementById('admin-email').value = settings.adminEmail;
            if (settings.gaId) document.getElementById('ga-id').value = settings.gaId;
            if (settings.linkedinUrl) document.getElementById('linkedin-url').value = settings.linkedinUrl;
            if (settings.facebookUrl) document.getElementById('facebook-url').value = settings.facebookUrl;
            if (settings.twitterUrl) document.getElementById('twitter-url').value = settings.twitterUrl;
            if (settings.githubUrl) document.getElementById('github-url').value = settings.githubUrl;
            if (settings.caseStudiesUrl) document.getElementById('case-studies-url').value = settings.caseStudiesUrl;
            if (settings.blogUrl) document.getElementById('blog-url').value = settings.blogUrl;
            
            document.getElementById('email-notifications-enabled').checked = settings.emailNotificationsEnabled !== false;
        }

        const CONTENT_MAP_PAGES = [
            '../index.html',
            '../pages/about.html',
            '../pages/contact.html',
            '../pages/collaborative-development.html',
            '../pages/express-development.html',
            '../pages/business-butler.html',
            '../pages/business-bootcamp.html',
            '../pages/privacy.html',
            '../pages/terms.html'
        ];

        /**
         * Load site content map data
         */
        function loadContentMapData() {
            const contentMap = JSON.parse(localStorage.getItem('cms_content_map') || '{}');
            renderContentMapEditor(contentMap);

            if (!contentMap || Object.keys(contentMap).length === 0) {
                loadContentMapFromPages();
            }
        }

        /**
         * Render the content map editor UI
         */
        function renderContentMapEditor(contentMap) {
            const container = document.getElementById('content-map-fields');
            if (!container) return;

            container.innerHTML = '';
            const keys = Object.keys(contentMap || {}).sort();

            if (keys.length === 0) {
                const empty = document.createElement('p');
                empty.className = 'help-text';
                empty.textContent = 'No content loaded yet. Use “Load Defaults from Site” to populate fields.';
                container.appendChild(empty);
            } else {
                keys.forEach(key => {
                    const group = document.createElement('div');
                    group.className = 'form-group';
                    group.dataset.contentMapKey = key;

                    const label = document.createElement('label');
                    label.className = 'form-label';
                    label.textContent = key;

                    const textarea = document.createElement('textarea');
                    textarea.className = 'form-textarea';
                    textarea.setAttribute('data-content-map-key', key);
                    textarea.value = contentMap[key] || '';

                    group.appendChild(label);
                    group.appendChild(textarea);
                    container.appendChild(group);
                });
            }

            const filterInput = document.getElementById('content-map-filter');
            if (filterInput && !filterInput.dataset.bound) {
                filterInput.addEventListener('input', filterContentMapFields);
                filterInput.dataset.bound = 'true';
            }
        }

        /**
         * Filter content map fields
         */
        function filterContentMapFields() {
            const input = document.getElementById('content-map-filter');
            const query = (input ? input.value : '').toLowerCase();

            document.querySelectorAll('#content-map-fields .form-group').forEach(group => {
                const key = (group.dataset.contentMapKey || '').toLowerCase();
                const textarea = group.querySelector('textarea');
                const value = (textarea ? textarea.value : '').toLowerCase();
                const matches = key.includes(query) || value.includes(query);
                group.style.display = matches ? '' : 'none';
            });
        }

        /**
         * Save the content map
         */
        function saveContentMap() {
            const contentMap = {};
            document.querySelectorAll('[data-content-map-key]').forEach(field => {
                const key = field.getAttribute('data-content-map-key');
                if (!key) return;
                contentMap[key] = SecurityUtils.sanitizeInput(field.value, 'html');
            });

            localStorage.setItem('cms_content_map', JSON.stringify(contentMap));
            showNotification('Site content saved successfully!', 'success');
        }

        /**
         * Load defaults from site pages
         */
        async function loadContentMapFromPages() {
            try {
                showNotification('Loading site content…', 'info');
                const contentMap = {};

                const responses = await Promise.all(CONTENT_MAP_PAGES.map(path =>
                    fetch(path)
                        .then(response => (response.ok ? response.text() : ''))
                        .catch(() => '')
                ));

                responses.forEach(html => {
                    if (!html) return;
                    const doc = new DOMParser().parseFromString(html, 'text/html');
                    doc.querySelectorAll('[data-cms]').forEach(el => {
                        const key = el.getAttribute('data-cms');
                        if (!key) return;
                        contentMap[key] = el.innerHTML.trim();
                    });
                });

                if (Object.keys(contentMap).length === 0) {
                    showNotification('No data-cms fields found on site pages.', 'error');
                    return;
                }

                localStorage.setItem('cms_content_map', JSON.stringify(contentMap));
                renderContentMapEditor(contentMap);
                showNotification('Site content loaded successfully!', 'success');
            } catch (error) {
                showNotification('Error loading site content: ' + error.message, 'error');
            }
        }

        /**
         * Clear content map overrides
         */
        function clearContentMap() {
            if (!confirm('Clear all site content overrides? This will revert to the default HTML content.')) {
                return;
            }
            localStorage.removeItem('cms_content_map');
            renderContentMapEditor({});
            showNotification('Site content cleared.', 'success');
        }

        /**
         * Load form submissions
         */
        function loadSubmissions() {
            const submissions = JSON.parse(localStorage.getItem('form_submissions') || '[]');
            const container = document.getElementById('formSubmissions');
            
            if (submissions.length === 0) {
                container.innerHTML = `
                    <div class="submission-card">
                        <div class="submission-header">
                            <div>
                                <p class="submission-meta"><strong>No submissions yet</strong></p>
                                <p class="submission-meta">Form submissions will appear here when visitors contact you.</p>
                            </div>
                        </div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = submissions.map(sub => `
                <div class="submission-card">
                    <div class="submission-header">
                        <div>
                            <p class="submission-meta"><strong>${sub.name}</strong> (${sub.email})</p>
                            <p class="submission-meta">Phone: ${sub.phone || 'Not provided'}</p>
                            <p class="submission-meta">Service: ${sub.service || 'Not specified'}</p>
                            <p class="submission-meta">Date: ${new Date(sub.timestamp).toLocaleString()}</p>
                        </div>
                        <div class="submission-actions">
                            <button class="btn btn-primary btn-small" onclick="respondToSubmission('${sub.email}')">
                                <i data-lucide="mail"></i> Reply
                            </button>
                        </div>
                    </div>
                    <p><strong>Message:</strong></p>
                    <p>${sub.message}</p>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        /**
         * Update statistics
         */
        function updateStats() {
            const submissions = JSON.parse(localStorage.getItem('form_submissions') || '[]');
            const homepage = JSON.parse(localStorage.getItem('cms_homepage_content') || '{}');
            
            document.getElementById('stat-submissions').textContent = submissions.length;
            
            if (homepage.lastUpdated) {
                const date = new Date(homepage.lastUpdated);
                document.getElementById('stat-updated').textContent = date.toLocaleDateString();
            }
            
            // Calculate storage used
            let totalSize = 0;
            for (let key in localStorage) {
                if (localStorage.hasOwnProperty(key)) {
                    totalSize += localStorage[key].length + key.length;
                }
            }
            const sizeKB = (totalSize / 1024).toFixed(2);
            document.getElementById('stat-storage').textContent = `${sizeKB} KB`;
            
            // Update status based on content completeness
            const hasHomepage = Object.keys(homepage).length > 0;
            const hasPricing = localStorage.getItem('cms_pricing') !== null;
            const hasAbout = localStorage.getItem('cms_about_content') !== null;
            
            if (hasHomepage && hasPricing && hasAbout) {
                document.getElementById('stat-status').textContent = 'Complete';
            } else if (hasHomepage) {
                document.getElementById('stat-status').textContent = 'Partial';
            } else {
                document.getElementById('stat-status').textContent = 'Empty';
            }
            
            lucide.createIcons();
        }

        /**
         * Save homepage content
         */
        function saveHomepageContent() {
            try {
                const rawContent = {
                    heroBadge: document.getElementById('hero-badge').value,
                    heroHeadline: document.getElementById('hero-headline').value,
                    heroSubheadlineHTML: editors.heroSubheadline.root.innerHTML,
                    heroSubheadlineText: editors.heroSubheadline.getText().trim(),
                    servicesTitle: document.getElementById('services-title').value,
                    servicesDescriptionHTML: editors.servicesDescription ? editors.servicesDescription.root.innerHTML : '',
                    servicesDescriptionText: editors.servicesDescription ? editors.servicesDescription.getText().trim() : '',
                    contactEmail: document.getElementById('contact-email').value,
                    contactPhone: document.getElementById('contact-phone').value
                };

                const content = {
                    heroBadge: SecurityUtils.sanitizeInput(rawContent.heroBadge, 'text'),
                    heroHeadline: SecurityUtils.sanitizeInput(rawContent.heroHeadline, 'text'),
                    heroSubheadlineHTML: SecurityUtils.sanitizeInput(rawContent.heroSubheadlineHTML, 'html'),
                    heroSubheadlineText: SecurityUtils.sanitizeInput(rawContent.heroSubheadlineText, 'text'),
                    servicesTitle: SecurityUtils.sanitizeInput(rawContent.servicesTitle, 'text'),
                    servicesDescriptionHTML: SecurityUtils.sanitizeInput(rawContent.servicesDescriptionHTML, 'html'),
                    servicesDescriptionText: SecurityUtils.sanitizeInput(rawContent.servicesDescriptionText, 'text'),
                    contactEmail: SecurityUtils.sanitizeInput(rawContent.contactEmail, 'email'),
                    contactPhone: SecurityUtils.sanitizeInput(rawContent.contactPhone, 'phone'),
                    lastUpdated: new Date().toISOString()
                };

                if (!content.heroHeadline || !content.contactEmail) {
                    throw new Error('Required fields are missing');
                }

                SecurityUtils.logSecurityEvent('admin_content_save', {
                    contentType: 'homepage',
                    fieldsUpdated: Object.keys(content)
                });

                localStorage.setItem('cms_homepage_content', JSON.stringify(content));
                showNotification('Homepage content saved successfully!', 'success');
                updateStats();

            } catch (error) {
                SecurityUtils.logSecurityEvent('admin_save_failed', {
                    contentType: 'homepage',
                    error: error.message
                });
                showNotification('Error saving content: ' + error.message, 'error');
            }
        }

        /**
         * Save pricing content
         */
        function savePricingContent() {
            const pricingGuide = Array.from({ length: 6 }, (_, index) => {
                const slot = index + 1;
                return {
                    label: document.getElementById(`pricing-guide-label-${slot}`).value,
                    range: document.getElementById(`pricing-guide-range-${slot}`).value
                };
            });

            const pricing = {
                customSolutions: {
                    price: document.getElementById('custom-solutions-price').value,
                    description: document.getElementById('custom-solutions-desc').value
                },
                websiteDevelopment: {
                    price: document.getElementById('website-development-price').value,
                    description: document.getElementById('website-development-desc').value
                },
                crmTools: {
                    price: document.getElementById('crm-tools-price').value,
                    description: document.getElementById('crm-tools-desc').value
                },
                workflowAutomation: {
                    price: document.getElementById('workflow-automation-price').value,
                    description: document.getElementById('workflow-automation-desc').value
                },
                voiceAutomation: {
                    price: document.getElementById('voice-automation-price').value,
                    description: document.getElementById('voice-automation-desc').value
                },
                dataAnalysis: {
                    price: document.getElementById('data-analysis-price').value,
                    description: document.getElementById('data-analysis-desc').value
                },
                discovery: document.getElementById('discovery-price').value,
                currency: document.getElementById('currency').value,
                pricingGuide,
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('cms_pricing', JSON.stringify(pricing));
            showNotification('Pricing saved successfully!', 'success');
        }

        /**
         * Save services content
         */
        function saveServicesContent() {
            const services = {
                customSolutions: {
                    taglineHTML: SecurityUtils.sanitizeInput(editors.customSolutionsTagline ? editors.customSolutionsTagline.root.innerHTML : '', 'html'),
                    taglineText: SecurityUtils.sanitizeInput(editors.customSolutionsTagline ? editors.customSolutionsTagline.getText().trim() : '', 'text')
                },
                websiteDevelopment: {
                    taglineHTML: SecurityUtils.sanitizeInput(editors.websiteDevelopmentTagline ? editors.websiteDevelopmentTagline.root.innerHTML : '', 'html'),
                    taglineText: SecurityUtils.sanitizeInput(editors.websiteDevelopmentTagline ? editors.websiteDevelopmentTagline.getText().trim() : '', 'text')
                },
                crmTools: {
                    taglineHTML: SecurityUtils.sanitizeInput(editors.crmToolsTagline ? editors.crmToolsTagline.root.innerHTML : '', 'html'),
                    taglineText: SecurityUtils.sanitizeInput(editors.crmToolsTagline ? editors.crmToolsTagline.getText().trim() : '', 'text')
                },
                workflowAutomation: {
                    taglineHTML: SecurityUtils.sanitizeInput(editors.workflowAutomationTagline ? editors.workflowAutomationTagline.root.innerHTML : '', 'html'),
                    taglineText: SecurityUtils.sanitizeInput(editors.workflowAutomationTagline ? editors.workflowAutomationTagline.getText().trim() : '', 'text')
                },
                voiceAutomation: {
                    taglineHTML: SecurityUtils.sanitizeInput(editors.voiceAutomationTagline ? editors.voiceAutomationTagline.root.innerHTML : '', 'html'),
                    taglineText: SecurityUtils.sanitizeInput(editors.voiceAutomationTagline ? editors.voiceAutomationTagline.getText().trim() : '', 'text')
                },
                dataAnalysis: {
                    taglineHTML: SecurityUtils.sanitizeInput(editors.dataAnalysisTagline ? editors.dataAnalysisTagline.root.innerHTML : '', 'html'),
                    taglineText: SecurityUtils.sanitizeInput(editors.dataAnalysisTagline ? editors.dataAnalysisTagline.getText().trim() : '', 'text')
                },
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('cms_services', JSON.stringify(services));
            showNotification('Services content saved successfully!', 'success');
        }

        /**
         * Save about content
         */
        function saveAboutContent() {
            const content = {
                aboutHeadline: document.getElementById('about-headline').value,
                aboutIntro: editors.aboutIntro.getContents(),
                aboutIntroText: editors.aboutIntro.getText().trim(),
                aboutDescription: editors.aboutDescription.getContents(),
                aboutDescriptionText: editors.aboutDescription.getText().trim(),
                timelineTitle: document.getElementById('timeline-title').value,
                philosophyTitle: document.getElementById('philosophy-title').value,
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('cms_about_content', JSON.stringify(content));
            showNotification('About page content saved successfully!', 'success');
        }

        /**
         * Save legal content
         */
        function saveLegalContent() {
            const content = {
                privacyUpdated: document.getElementById('privacy-updated').value,
                termsUpdated: document.getElementById('terms-updated').value,
                legalEmail: document.getElementById('legal-email').value,
                legalPhone: document.getElementById('legal-phone').value,
                privacyContent: editors.privacyContent.getContents(),
                privacyContentHTML: editors.privacyContent.root.innerHTML,
                privacyContentText: editors.privacyContent.getText().trim(),
                termsContent: editors.termsContent.getContents(),
                termsContentHTML: editors.termsContent.root.innerHTML,
                termsContentText: editors.termsContent.getText().trim(),
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('cms_legal_content', JSON.stringify(content));
            showNotification('Legal content saved successfully! Refresh the Privacy and Terms pages to see changes.', 'success');
            updateStats();
        }

        /**
         * Save settings
         */
        function saveSettings() {
            const settings = {
                adminEmail: document.getElementById('admin-email').value,
                emailNotificationsEnabled: document.getElementById('email-notifications-enabled').checked,
                gaId: document.getElementById('ga-id').value,
                linkedinUrl: document.getElementById('linkedin-url').value,
                facebookUrl: document.getElementById('facebook-url').value,
                twitterUrl: document.getElementById('twitter-url').value,
                githubUrl: document.getElementById('github-url').value,
                caseStudiesUrl: document.getElementById('case-studies-url').value,
                blogUrl: document.getElementById('blog-url').value,
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('cms_settings', JSON.stringify(settings));
            showNotification('Settings saved successfully! Email notifications will be sent to ' + settings.adminEmail, 'success');
        }

        /**
         * Sync all data-cms elements into a content map for the CMS loader
         */
        function syncContentMapFromPage() {
            const contentMap = {};
            document.querySelectorAll('[data-cms]').forEach(el => {
                const key = el.getAttribute('data-cms');
                if (!key) return;
                contentMap[key] = el.innerHTML.trim();
            });

            if (Object.keys(contentMap).length > 0) {
                localStorage.setItem('cms_content_map', JSON.stringify(contentMap));
            }
            return contentMap;
        }

        // Populate content map on load for admin preview usage
        document.addEventListener('DOMContentLoaded', () => {
            syncContentMapFromPage();
        });

        /**
         * Preview changes in new tab
         * @param {string} page - Page to preview
         */
        function previewChanges(page) {
            const previewWindow = window.open(page || '../index.html', '_blank');
            showNotification('Preview opened in new tab', 'info');
        }

        /**
         * Export pricing data
         */
        function exportPricing() {
            const pricing = JSON.parse(localStorage.getItem('cms_pricing') || '{}');
            const dataStr = JSON.stringify(pricing, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `pricing-export-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showNotification('Pricing exported successfully!', 'success');
        }

        /**
         * Clear cache
         */
        function clearCache() {
            if (confirm('Are you sure you want to clear all cached data? This will NOT delete your saved content.')) {
                // Clear only temporary cache, not saved content
                showNotification('Cache cleared successfully!', 'success');
            }
        }

        /**
         * Export all CMS content
         */
        function exportAllContent() {
            const allContent = {};
            
            // Collect all CMS data
            for (let key in localStorage) {
                if (localStorage.hasOwnProperty(key) && key.startsWith('cms_')) {
                    allContent[key] = JSON.parse(localStorage.getItem(key));
                }
            }
            
            // Add metadata
            allContent._metadata = {
                exportDate: new Date().toISOString(),
                version: '2.0.0',
                site: 'Lightbridge Consulting'
            };
            
            // Create download
            const dataStr = JSON.stringify(allContent, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `lightbridge-cms-export-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            
            showNotification('All content exported successfully!', 'success');
        }

        /**
         * Import all CMS content
         */
        function importAllContent(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // Validate import
                    if (!importedData._metadata) {
                        throw new Error('Invalid export file format');
                    }
                    
                    // Confirm import
                    if (!confirm(`Import content from ${new Date(importedData._metadata.exportDate).toLocaleDateString()}? This will overwrite current content.`)) {
                        return;
                    }
                    
                    // Import all data
                    let importCount = 0;
                    for (let key in importedData) {
                        if (key !== '_metadata' && key.startsWith('cms_')) {
                            localStorage.setItem(key, JSON.stringify(importedData[key]));
                            importCount++;
                        }
                    }
                    
                    // Reload data
                    loadAdminData();
                    updateStats();
                    
                    showNotification(`Successfully imported ${importCount} content items!`, 'success');
                    
                } catch (error) {
                    showNotification('Error importing content: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }

        /**
         * Respond to submission via email
         * @param {string} email - Recipient email
         */
        function respondToSubmission(email) {
            const subject = encodeURIComponent('Re: Your inquiry to Lightbridge Consulting');
            const body = encodeURIComponent(`Thank you for reaching out to Lightbridge Consulting. I've received your message and will be happy to discuss your project.\n\nI'd like to schedule a brief call to better understand your needs. Are you available for a 15-minute conversation this week?\n\nBest regards,\nShawn Ferguson\nLightbridge Consulting`);

            window.open(`mailto:${email}?subject=${subject}&body=${body}`);
        }

        /**
         * Show notification message
         * @param {string} message - Notification message
         * @param {string} type - Notification type (success, error, info)
         */
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 16px 24px;
                background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#1F78B4'};
                color: white;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-weight: 600;
                max-width: 400px;
            `;
            notification.textContent = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Auto-refresh submissions every 30 seconds
        setInterval(() => {
            loadSubmissions();
            updateStats();
        }, 30000);
    </script>
</body>
</html>
